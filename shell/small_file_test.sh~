#!/bin/bash

local_dir="./small_file"
remote_dir="small_file"
# MB
total_file_size=315

gsutil -q -m rm -r gs://vobile-ugc-test/"$remote_dir"

start_time=$(date +%s)
#gsutil cp "$local_dir"/* gs://vobile-ugc-test/"$remote_dir"
gsutil -q -m cp "$local_dir"/* gs://vobile-ugc-test/"$remote_dir"
end_time=$(date +%s)

total_time=$((end_time-start_time))
throughput=$(awk -v a=$total_file_size -v b=$total_time 'BEGIN{printf "%.1f", a/b}')
echo $(grep 'parallel_process_count = ' /home/zhu_liting/.boto)
echo $(grep 'parallel_thread_count = ' /home/zhu_liting/.boto)
echo "time used: " $total_time "S"
echo "throughput: " $throughput " MB/S"
